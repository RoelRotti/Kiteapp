<?php $this->extends('layout.phtml') ?>

<?php $this->begin('content') ?>
<section class="completed">
	<h2>Conclusions</h2>
	<dl>
	<?php foreach ($domain->goals as $goal): ?>
		<?php $real_goal_name = $state->resolve($goal->name); ?>
		<?php if ($goal->hasAnswers() && (($answer = $goal->answer($state)) || $state->value($real_goal_name) != STATE_UNDEFINED)): ?>
			<dt><?=$state->substitute_variables($goal->description, ['Template', 'html'])?></dt>
			<dd><?php
				echo $answer
					? $state->substitute_variables($answer->description, ['Template', 'html'])
					: '<pre>' . $state->value($real_goal_name) . '</pre>';
				?></p>
				<?php if ($state->reason($real_goal_name) !== null): ?>
					<div class="explanation">
						<ol><?= (new HTMLFormatter($state))->formatReason($state->reason($real_goal_name)) ?></ol>
					</div>
				<?php endif ?>
			<?php endif ?>
	<?php endforeach ?>
</section>
<?php $this->end() ?>